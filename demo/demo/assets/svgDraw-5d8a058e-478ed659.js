var k=Object.defineProperty;var x=(i,e)=>k(i,"name",{value:e,configurable:!0});import{H as O,z as N,l as f,I as S}from"./mermaid-a98f434b-6ad3a326.js";import{l as P}from"./line-b92a72a5.js";let _=0;const A=x(function(i,e,t,a,r){const o=x(function(d){switch(d){case r.db.relationType.AGGREGATION:return"aggregation";case r.db.relationType.EXTENSION:return"extension";case r.db.relationType.COMPOSITION:return"composition";case r.db.relationType.DEPENDENCY:return"dependency";case r.db.relationType.LOLLIPOP:return"lollipop"}},"getRelationType");e.points=e.points.filter(d=>!Number.isNaN(d.y));const l=e.points,g=P().x(function(d){return d.x}).y(function(d){return d.y}).curve(O),s=i.append("path").attr("d",g(l)).attr("id","edge"+_).attr("class","relation");let p="";a.arrowMarkerAbsolute&&(p=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,p=p.replace(/\(/g,"\\("),p=p.replace(/\)/g,"\\)")),t.relation.lineType==1&&s.attr("class","relation dashed-line"),t.relation.lineType==10&&s.attr("class","relation dotted-line"),t.relation.type1!=="none"&&s.attr("marker-start","url("+p+"#"+o(t.relation.type1)+"Start)"),t.relation.type2!=="none"&&s.attr("marker-end","url("+p+"#"+o(t.relation.type2)+"End)");let h,n;const c=e.points.length;let m=N.calcLabelPosition(e.points);h=m.x,n=m.y;let u,w,v,B;if(c%2!==0&&c>1){let d=N.calcCardinalityPosition(t.relation.type1!=="none",e.points,e.points[0]),T=N.calcCardinalityPosition(t.relation.type2!=="none",e.points,e.points[c-1]);f.debug("cardinality_1_point "+JSON.stringify(d)),f.debug("cardinality_2_point "+JSON.stringify(T)),u=d.x,w=d.y,v=T.x,B=T.y}if(t.title!==void 0){const d=i.append("g").attr("class","classLabel"),T=d.append("text").attr("class","label").attr("x",h).attr("y",n).attr("fill","red").attr("text-anchor","middle").text(t.title);window.label=T;const y=T.node().getBBox();d.insert("rect",":first-child").attr("class","box").attr("x",y.x-a.padding/2).attr("y",y.y-a.padding/2).attr("width",y.width+a.padding).attr("height",y.height+a.padding)}f.info("Rendering relation "+JSON.stringify(t)),t.relationTitle1!==void 0&&t.relationTitle1!=="none"&&i.append("g").attr("class","cardinality").append("text").attr("class","type1").attr("x",u).attr("y",w).attr("fill","black").attr("font-size","6").text(t.relationTitle1),t.relationTitle2!==void 0&&t.relationTitle2!=="none"&&i.append("g").attr("class","cardinality").append("text").attr("class","type2").attr("x",v).attr("y",B).attr("fill","black").attr("font-size","6").text(t.relationTitle2),_++},"drawEdge"),L=x(function(i,e,t,a){f.debug("Rendering class ",e,t);const r=e.id,o={id:r,label:e.id,width:0,height:0},l=i.append("g").attr("id",a.db.lookUpDomId(r)).attr("class","classGroup");let g;e.link?g=l.append("svg:a").attr("xlink:href",e.link).attr("target",e.linkTarget).append("text").attr("y",t.textHeight+t.padding).attr("x",0):g=l.append("text").attr("y",t.textHeight+t.padding).attr("x",0);let s=!0;e.annotations.forEach(function(b){const I=g.append("tspan").text("«"+b+"»");s||I.attr("dy",t.textHeight),s=!1});let p=M(e);const h=g.append("tspan").text(p).attr("class","title");s||h.attr("dy",t.textHeight);const n=g.node().getBBox().height,c=l.append("line").attr("x1",0).attr("y1",t.padding+n+t.dividerMargin/2).attr("y2",t.padding+n+t.dividerMargin/2),m=l.append("text").attr("x",t.padding).attr("y",n+t.dividerMargin+t.textHeight).attr("fill","white").attr("class","classText");s=!0,e.members.forEach(function(b){C(m,b,s,t),s=!1});const u=m.node().getBBox(),w=l.append("line").attr("x1",0).attr("y1",t.padding+n+t.dividerMargin+u.height).attr("y2",t.padding+n+t.dividerMargin+u.height),v=l.append("text").attr("x",t.padding).attr("y",n+2*t.dividerMargin+u.height+t.textHeight).attr("fill","white").attr("class","classText");s=!0,e.methods.forEach(function(b){C(v,b,s,t),s=!1});const B=l.node().getBBox();var d=" ";e.cssClasses.length>0&&(d=d+e.cssClasses.join(" "));const y=l.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",B.width+2*t.padding).attr("height",B.height+t.padding+.5*t.dividerMargin).attr("class",d).node().getBBox().width;return g.node().childNodes.forEach(function(b){b.setAttribute("x",(y-b.getBBox().width)/2)}),e.tooltip&&g.insert("title").text(e.tooltip),c.attr("x2",y),w.attr("x2",y),o.width=y,o.height=B.height+t.padding+.5*t.dividerMargin,o},"drawClass"),M=x(function(i){let e=i.id;return i.type&&(e+="<"+i.type+">"),e},"getClassTitleString"),G=x(function(i,e,t,a){f.debug("Rendering note ",e,t);const r=e.id,o={id:r,text:e.text,width:0,height:0},l=i.append("g").attr("id",r).attr("class","classGroup");let g=l.append("text").attr("y",t.textHeight+t.padding).attr("x",0);const s=JSON.parse(`"${e.text}"`).split(`
`);s.forEach(function(c){f.debug(`Adding line: ${c}`),g.append("tspan").text(c).attr("class","title").attr("dy",t.textHeight)});const p=l.node().getBBox(),n=l.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",p.width+2*t.padding).attr("height",p.height+s.length*t.textHeight+t.padding+.5*t.dividerMargin).node().getBBox().width;return g.node().childNodes.forEach(function(c){c.setAttribute("x",(n-c.getBBox().width)/2)}),o.width=n,o.height=p.height+s.length*t.textHeight+t.padding+.5*t.dividerMargin,o},"drawNote"),H=x(function(i){let e="",t="",a="",r="",o=i.substring(0,1),l=i.substring(i.length-1,i.length);o.match(/[#+~-]/)&&(r=o);let g=/[\s\w)~]/;l.match(g)||(t=E(l));const s=r===""?0:1;let p=t===""?i.length:i.length-1;i=i.substring(s,p);const h=i.indexOf("("),n=i.indexOf(")");if(h>1&&n>h&&n<=i.length){let m=i.substring(0,h).trim();const u=i.substring(h+1,n);if(e=r+m+"("+S(u.trim())+")",n<i.length){let w=i.substring(n+1,n+2);t===""&&!w.match(g)?(t=E(w),a=i.substring(n+2).trim()):a=i.substring(n+1).trim(),a!==""&&(a.charAt(0)===":"&&(a=a.substring(1).trim()),a=" : "+S(a),e+=a)}}else e=r+S(i);return{displayText:e,cssStyle:t}},"parseMember"),C=x(function(i,e,t,a){let r=H(e);const o=i.append("tspan").attr("x",a.padding).text(r.displayText);r.cssStyle!==""&&o.attr("style",r.cssStyle),t||o.attr("dy",a.textHeight)},"addTspan"),E=x(function(i){switch(i){case"*":return"font-style:italic;";case"$":return"text-decoration:underline;";default:return""}},"parseClassifier"),z={getClassTitleString:M,drawClass:L,drawEdge:A,drawNote:G,parseMember:H};export{H as p,z as s};
//# sourceMappingURL=svgDraw-5d8a058e-478ed659.js.map
