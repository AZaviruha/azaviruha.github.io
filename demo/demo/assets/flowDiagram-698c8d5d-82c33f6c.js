var Lt=Object.defineProperty;var l=(r,t)=>Lt(r,"name",{value:t,configurable:!0});import{p as Et,f as V}from"./flowDb-8f9fc471-f2a1a3a8.js";import{h as L,u as _t,r as Tt,p as Nt,l as At,d as R,f as et,G as Ct}from"./layout-06a9841d.js";import{i as b,p as U,q as Y,r as rt,c as K,k as at,l as D,t as z,u as It}from"./mermaid-a98f434b-6ad3a326.js";import{a as A,b as nt,i as st,c as T,e as it,d as ot,f as Bt,g as Mt,s as Dt}from"./styles-ff678862-0cc8131d.js";import{l as Rt}from"./line-b92a72a5.js";import"./get-fec7d053.js";import"./isArray-6de4a062.js";import"./isSymbol-3167caec.js";import"./memoize-a38ec700.js";import"./_MapCache-7e836c94.js";import"./toString-40b958f3.js";import"./_getTag-9b3eabd6.js";import"./now-f5237b2a.js";import"./_arrayReduce-b962fc90.js";import"./preload-helper-d51aff73.js";import"./index-32ac9e7b.js";import"./_commonjsHelpers-df0bf62c.js";import"./index-4c4adb72-f5a5e4b7.js";import"./edges-b00f0ec2-afddb99d.js";import"./createText-285e50b4-c51484b0.js";import"./svgDraw-5d8a058e-478ed659.js";import"./array-2d8cd92e.js";import"./path-56a6d420.js";function Gt(r){if(!r.ok)throw new Error(r.status+" "+r.statusText);return r.text()}l(Gt,"responseText");function Pt(r,t){return fetch(r,t).then(Gt)}l(Pt,"text");function Ut(r){return(t,e)=>Pt(t,e).then(n=>new DOMParser().parseFromString(n,r))}l(Ut,"parser");var $t=Ut("image/svg+xml"),H={normal:Vt,vee:zt,undirected:Yt};function Wt(r){H=r}l(Wt,"setArrows");function Vt(r,t,e,n){var a=r.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 0 L 10 5 L 0 10 z").style("stroke-width",1).style("stroke-dasharray","1,0");A(s,e[n+"Style"]),e[n+"Class"]&&s.attr("class",e[n+"Class"])}l(Vt,"normal");function zt(r,t,e,n){var a=r.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 0 L 10 5 L 0 10 L 4 5 z").style("stroke-width",1).style("stroke-dasharray","1,0");A(s,e[n+"Style"]),e[n+"Class"]&&s.attr("class",e[n+"Class"])}l(zt,"vee");function Yt(r,t,e,n){var a=r.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 5 L 10 5").style("stroke-width",1).style("stroke-dasharray","1,0");A(s,e[n+"Style"]),e[n+"Class"]&&s.attr("class",e[n+"Class"])}l(Yt,"undirected");function Ht(r,t){var e=r;return e.node().appendChild(t.label),A(e,t.labelStyle),e}l(Ht,"addSVGLabel");function Xt(r,t){for(var e=r.append("text"),n=Ft(t.label).split(`
`),a=0;a<n.length;a++)e.append("tspan").attr("xml:space","preserve").attr("dy","1em").attr("x","1").text(n[a]);return A(e,t.labelStyle),e}l(Xt,"addTextLabel");function Ft(r){for(var t="",e=!1,n,a=0;a<r.length;++a)if(n=r[a],e){switch(n){case"n":t+=`
`;break;default:t+=n}e=!1}else n==="\\"?e=!0:t+=n;return t}l(Ft,"processEscapeSequences");function Z(r,t,e){var n=t.label,a=r.append("g");t.labelType==="svg"?Ht(a,t):typeof n!="string"||t.labelType==="html"?nt(a,t):Xt(a,t);var s=a.node().getBBox(),i;switch(e){case"top":i=-t.height/2;break;case"bottom":i=t.height/2-s.height;break;default:i=-s.height/2}return a.attr("transform","translate("+-s.width/2+","+i+")"),a}l(Z,"addLabel");var X=l(function(r,t){var e=t.nodes().filter(function(s){return st(t,s)}),n=r.selectAll("g.cluster").data(e,function(s){return s});T(n.exit(),t).style("opacity",0).remove();var a=n.enter().append("g").attr("class","cluster").attr("id",function(s){var i=t.node(s);return i.id}).style("opacity",0).each(function(s){var i=t.node(s),o=b(this);b(this).append("rect");var d=o.append("g").attr("class","label");Z(d,i,i.clusterLabelPos)});return n=n.merge(a),n=T(n,t).style("opacity",1),n.selectAll("rect").each(function(s){var i=t.node(s),o=b(this);A(o,i.style)}),n},"createClusters");function qt(r){X=r}l(qt,"setCreateClusters");let F=l(function(r,t){var e=r.selectAll("g.edgeLabel").data(t.edges(),function(a){return it(a)}).classed("update",!0);e.exit().remove(),e.enter().append("g").classed("edgeLabel",!0).style("opacity",0),e=r.selectAll("g.edgeLabel"),e.each(function(a){var s=b(this);s.select(".label").remove();var i=t.edge(a),o=Z(s,t.edge(a),0).classed("label",!0),d=o.node().getBBox();i.labelId&&o.attr("id",i.labelId),L(i,"width")||(i.width=d.width),L(i,"height")||(i.height=d.height)});var n;return e.exit?n=e.exit():n=e.selectAll(null),T(n,t).style("opacity",0).remove(),e},"createEdgeLabels");function Qt(r){F=r}l(Qt,"setCreateEdgeLabels");function j(r,t){return r.intersect(t)}l(j,"intersectNode");var q=l(function(r,t,e){var n=r.selectAll("g.edgePath").data(t.edges(),function(i){return it(i)}).classed("update",!0),a=jt(n,t);te(n,t);var s=n.merge!==void 0?n.merge(a):n;return T(s,t).style("opacity",1),s.each(function(i){var o=b(this),d=t.edge(i);d.elem=this,d.id&&o.attr("id",d.id),ot(o,d.class,(o.classed("update")?"update ":"")+"edgePath")}),s.selectAll("path.path").each(function(i){var o=t.edge(i);o.arrowheadId=_t("arrowhead");var d=b(this).attr("marker-end",function(){return"url("+Kt(location.href,o.arrowheadId)+")"}).style("fill","none");T(d,t).attr("d",function(h){return Zt(t,h)}),A(d,o.style)}),s.selectAll("defs *").remove(),s.selectAll("defs").each(function(i){var o=t.edge(i),d=e[o.arrowhead];d(b(this),o.arrowheadId,o,"arrowhead")}),s},"createEdgePaths");function Jt(r){q=r}l(Jt,"setCreateEdgePaths");function Kt(r,t){var e=r.split("#")[0];return e+"#"+t}l(Kt,"makeFragmentRef");function Zt(r,t){var e=r.edge(t),n=r.node(t.v),a=r.node(t.w),s=e.points.slice(1,e.points.length-1);return s.unshift(j(n,s[0])),s.push(j(a,s[s.length-1])),lt(e,s)}l(Zt,"calcPoints");function lt(r,t){var e=(Rt||$t.line)().x(function(n){return n.x}).y(function(n){return n.y});return(e.curve||e.interpolate)(r.curve),e(t)}l(lt,"createLine");function Ot(r){var t=r.getBBox(),e=r.ownerSVGElement.getScreenCTM().inverse().multiply(r.getScreenCTM()).translate(t.width/2,t.height/2);return{x:e.e,y:e.f}}l(Ot,"getCoords");function jt(r,t){var e=r.enter().append("g").attr("class","edgePath").style("opacity",0);return e.append("path").attr("class","path").attr("d",function(n){var a=t.edge(n),s=t.node(n.v).elem,i=Tt(a.points.length).map(function(){return Ot(s)});return lt(a,i)}),e.append("defs"),e}l(jt,"enter");function te(r,t){var e=r.exit();T(e,t).style("opacity",0).remove()}l(te,"exit");var Q=l(function(r,t,e){var n=t.nodes().filter(function(i){return!st(t,i)}),a=r.selectAll("g.node").data(n,function(i){return i}).classed("update",!0);a.exit().remove(),a.enter().append("g").attr("class","node").style("opacity",0),a=r.selectAll("g.node"),a.each(function(i){var o=t.node(i),d=b(this);ot(d,o.class,(d.classed("update")?"update ":"")+"node"),d.select("g.label").remove();var h=d.append("g").attr("class","label"),c=Z(h,o),y=e[o.shape],u=Nt(c.node().getBBox(),"width","height");o.elem=this,o.id&&d.attr("id",o.id),o.labelId&&h.attr("id",o.labelId),L(o,"width")&&(u.width=o.width),L(o,"height")&&(u.height=o.height),u.width+=o.paddingLeft+o.paddingRight,u.height+=o.paddingTop+o.paddingBottom,h.attr("transform","translate("+(o.paddingLeft-o.paddingRight)/2+","+(o.paddingTop-o.paddingBottom)/2+")");var f=b(this);f.select(".label-container").remove();var v=y(f,u,o).classed("label-container",!0);A(v,o.style);var m=v.node().getBBox();o.width=m.width,o.height=m.height});var s;return a.exit?s=a.exit():s=a.selectAll(null),T(s,t).style("opacity",0).remove(),a},"createNodes");function ee(r){Q=r}l(ee,"setCreateNodes");function re(r,t){var e=r.filter(function(){return!b(this).classed("update")});function n(a){var s=t.node(a);return"translate("+s.x+","+s.y+")"}l(n,"translate"),e.attr("transform",n),T(r,t).style("opacity",1).attr("transform",n),T(e.selectAll("rect"),t).attr("width",function(a){return t.node(a).width}).attr("height",function(a){return t.node(a).height}).attr("x",function(a){var s=t.node(a);return-s.width/2}).attr("y",function(a){var s=t.node(a);return-s.height/2})}l(re,"positionClusters");function ae(r,t){var e=r.filter(function(){return!b(this).classed("update")});function n(a){var s=t.edge(a);return L(s,"x")?"translate("+s.x+","+s.y+")":""}l(n,"translate"),e.attr("transform",n),T(r,t).style("opacity",1).attr("transform",n)}l(ae,"positionEdgeLabels");function ne(r,t){var e=r.filter(function(){return!b(this).classed("update")});function n(a){var s=t.node(a);return"translate("+s.x+","+s.y+")"}l(n,"translate"),e.attr("transform",n),T(r,t).style("opacity",1).attr("transform",n)}l(ne,"positionNodes");function ct(r,t,e,n){var a=r.x,s=r.y,i=a-n.x,o=s-n.y,d=Math.sqrt(t*t*o*o+e*e*i*i),h=Math.abs(t*e*i/d);n.x<a&&(h=-h);var c=Math.abs(t*e*o/d);return n.y<s&&(c=-c),{x:a+h,y:s+c}}l(ct,"intersectEllipse");function se(r,t,e){return ct(r,t,t,e)}l(se,"intersectCircle");function ie(r,t,e,n){var a,s,i,o,d,h,c,y,u,f,v,m,p,g,S;if(a=t.y-r.y,i=r.x-t.x,d=t.x*r.y-r.x*t.y,u=a*e.x+i*e.y+d,f=a*n.x+i*n.y+d,!(u!==0&&f!==0&&tt(u,f))&&(s=n.y-e.y,o=e.x-n.x,h=n.x*e.y-e.x*n.y,c=s*r.x+o*r.y+h,y=s*t.x+o*t.y+h,!(c!==0&&y!==0&&tt(c,y))&&(v=a*o-s*i,v!==0)))return m=Math.abs(v/2),p=i*h-o*d,g=p<0?(p-m)/v:(p+m)/v,p=s*d-a*h,S=p<0?(p-m)/v:(p+m)/v,{x:g,y:S}}l(ie,"intersectLine");function tt(r,t){return r*t>0}l(tt,"sameSign");function N(r,t,e){var n=r.x,a=r.y,s=[],i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;t.forEach(function(v){i=Math.min(i,v.x),o=Math.min(o,v.y)});for(var d=n-r.width/2-i,h=a-r.height/2-o,c=0;c<t.length;c++){var y=t[c],u=t[c<t.length-1?c+1:0],f=ie(r,e,{x:d+y.x,y:h+y.y},{x:d+u.x,y:h+u.y});f&&s.push(f)}return s.length?(s.length>1&&s.sort(function(v,m){var p=v.x-e.x,g=v.y-e.y,S=Math.sqrt(p*p+g*g),B=m.x-e.x,_=m.y-e.y,$=Math.sqrt(B*B+_*_);return S<$?-1:S===$?0:1}),s[0]):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",r),r)}l(N,"intersectPolygon");function O(r,t){var e=r.x,n=r.y,a=t.x-e,s=t.y-n,i=r.width/2,o=r.height/2,d,h;return Math.abs(s)*i>Math.abs(a)*o?(s<0&&(o=-o),d=s===0?0:o*a/s,h=o):(a<0&&(i=-i),d=i,h=a===0?0:i*s/a),{x:e+d,y:n+h}}l(O,"intersectRect");var J={rect:le,ellipse:ce,circle:de,diamond:he};function oe(r){J=r}l(oe,"setShapes");function le(r,t,e){var n=r.insert("rect",":first-child").attr("rx",e.rx).attr("ry",e.ry).attr("x",-t.width/2).attr("y",-t.height/2).attr("width",t.width).attr("height",t.height);return e.intersect=function(a){return O(e,a)},n}l(le,"rect");function ce(r,t,e){var n=t.width/2,a=t.height/2,s=r.insert("ellipse",":first-child").attr("x",-t.width/2).attr("y",-t.height/2).attr("rx",n).attr("ry",a);return e.intersect=function(i){return ct(e,n,a,i)},s}l(ce,"ellipse");function de(r,t,e){var n=Math.max(t.width,t.height)/2,a=r.insert("circle",":first-child").attr("x",-t.width/2).attr("y",-t.height/2).attr("r",n);return e.intersect=function(s){return se(e,n,s)},a}l(de,"circle");function he(r,t,e){var n=t.width*Math.SQRT2/2,a=t.height*Math.SQRT2/2,s=[{x:0,y:-a},{x:-n,y:0},{x:0,y:a},{x:n,y:0}],i=r.insert("polygon",":first-child").attr("points",s.map(function(o){return o.x+","+o.y}).join(" "));return e.intersect=function(o){return N(e,s,o)},i}l(he,"diamond");function ue(){var r=l(function(t,e){ve(e);var n=G(t,"output"),a=G(n,"clusters"),s=G(n,"edgePaths"),i=F(G(n,"edgeLabels"),e),o=Q(G(n,"nodes"),e,J);At(e),ne(o,e),ae(i,e),q(s,e,H);var d=X(a,e);re(d,e),ye(e)},"fn");return r.createNodes=function(t){return arguments.length?(ee(t),r):Q},r.createClusters=function(t){return arguments.length?(qt(t),r):X},r.createEdgeLabels=function(t){return arguments.length?(Qt(t),r):F},r.createEdgePaths=function(t){return arguments.length?(Jt(t),r):q},r.shapes=function(t){return arguments.length?(oe(t),r):J},r.arrows=function(t){return arguments.length?(Wt(t),r):H},r}l(ue,"render");var fe={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},pe={arrowhead:"normal",curve:U};function ve(r){r.nodes().forEach(function(t){var e=r.node(t);!L(e,"label")&&!r.children(t).length&&(e.label=t),L(e,"paddingX")&&R(e,{paddingLeft:e.paddingX,paddingRight:e.paddingX}),L(e,"paddingY")&&R(e,{paddingTop:e.paddingY,paddingBottom:e.paddingY}),L(e,"padding")&&R(e,{paddingLeft:e.padding,paddingRight:e.padding,paddingTop:e.padding,paddingBottom:e.padding}),R(e,fe),et(["paddingLeft","paddingRight","paddingTop","paddingBottom"],function(n){e[n]=Number(e[n])}),L(e,"width")&&(e._prevWidth=e.width),L(e,"height")&&(e._prevHeight=e.height)}),r.edges().forEach(function(t){var e=r.edge(t);L(e,"label")||(e.label=""),R(e,pe)})}l(ve,"preProcessGraph");function ye(r){et(r.nodes(),function(t){var e=r.node(t);L(e,"_prevWidth")?e.width=e._prevWidth:delete e.width,L(e,"_prevHeight")?e.height=e._prevHeight:delete e.height,delete e._prevWidth,delete e._prevHeight})}l(ye,"postProcessGraph");function G(r,t){var e=r.select("g."+t);return e.empty()&&(e=r.append("g").attr("class",t)),e}l(G,"createOrSelectGroup");function dt(r,t,e){const n=t.width,a=t.height,s=(n+a)*.9,i=[{x:s/2,y:0},{x:s,y:-s/2},{x:s/2,y:-s},{x:0,y:-s/2}],o=C(r,s,s,i);return e.intersect=function(d){return N(e,i,d)},o}l(dt,"question");function ht(r,t,e){const a=t.height,s=a/4,i=t.width+2*s,o=[{x:s,y:0},{x:i-s,y:0},{x:i,y:-a/2},{x:i-s,y:-a},{x:s,y:-a},{x:0,y:-a/2}],d=C(r,i,a,o);return e.intersect=function(h){return N(e,o,h)},d}l(ht,"hexagon");function ut(r,t,e){const n=t.width,a=t.height,s=[{x:-a/2,y:0},{x:n,y:0},{x:n,y:-a},{x:-a/2,y:-a},{x:0,y:-a/2}],i=C(r,n,a,s);return e.intersect=function(o){return N(e,s,o)},i}l(ut,"rect_left_inv_arrow");function ft(r,t,e){const n=t.width,a=t.height,s=[{x:-2*a/6,y:0},{x:n-a/6,y:0},{x:n+2*a/6,y:-a},{x:a/6,y:-a}],i=C(r,n,a,s);return e.intersect=function(o){return N(e,s,o)},i}l(ft,"lean_right");function pt(r,t,e){const n=t.width,a=t.height,s=[{x:2*a/6,y:0},{x:n+a/6,y:0},{x:n-2*a/6,y:-a},{x:-a/6,y:-a}],i=C(r,n,a,s);return e.intersect=function(o){return N(e,s,o)},i}l(pt,"lean_left");function vt(r,t,e){const n=t.width,a=t.height,s=[{x:-2*a/6,y:0},{x:n+2*a/6,y:0},{x:n-a/6,y:-a},{x:a/6,y:-a}],i=C(r,n,a,s);return e.intersect=function(o){return N(e,s,o)},i}l(vt,"trapezoid");function yt(r,t,e){const n=t.width,a=t.height,s=[{x:a/6,y:0},{x:n-a/6,y:0},{x:n+2*a/6,y:-a},{x:-2*a/6,y:-a}],i=C(r,n,a,s);return e.intersect=function(o){return N(e,s,o)},i}l(yt,"inv_trapezoid");function gt(r,t,e){const n=t.width,a=t.height,s=[{x:0,y:0},{x:n+a/2,y:0},{x:n,y:-a/2},{x:n+a/2,y:-a},{x:0,y:-a}],i=C(r,n,a,s);return e.intersect=function(o){return N(e,s,o)},i}l(gt,"rect_right_inv_arrow");function mt(r,t,e){const n=t.height,a=t.width+n/4,s=r.insert("rect",":first-child").attr("rx",n/2).attr("ry",n/2).attr("x",-a/2).attr("y",-n/2).attr("width",a).attr("height",n);return e.intersect=function(i){return O(e,i)},s}l(mt,"stadium");function wt(r,t,e){const n=t.width,a=t.height,s=[{x:0,y:0},{x:n,y:0},{x:n,y:-a},{x:0,y:-a},{x:0,y:0},{x:-8,y:0},{x:n+8,y:0},{x:n+8,y:-a},{x:-8,y:-a},{x:-8,y:0}],i=C(r,n,a,s);return e.intersect=function(o){return N(e,s,o)},i}l(wt,"subroutine");function xt(r,t,e){const n=t.width,a=n/2,s=a/(2.5+n/50),i=t.height+s,o="M 0,"+s+" a "+a+","+s+" 0,0,0 "+n+" 0 a "+a+","+s+" 0,0,0 "+-n+" 0 l 0,"+i+" a "+a+","+s+" 0,0,0 "+n+" 0 l 0,"+-i,d=r.attr("label-offset-y",s).insert("path",":first-child").attr("d",o).attr("transform","translate("+-n/2+","+-(i/2+s)+")");return e.intersect=function(h){const c=O(e,h),y=c.x-e.x;if(a!=0&&(Math.abs(y)<e.width/2||Math.abs(y)==e.width/2&&Math.abs(c.y-e.y)>e.height/2-s)){let u=s*s*(1-y*y/(a*a));u!=0&&(u=Math.sqrt(u)),u=s-u,h.y-e.y>0&&(u=-u),c.y+=u}return c},d}l(xt,"cylinder");function ge(r){r.shapes().question=dt,r.shapes().hexagon=ht,r.shapes().stadium=mt,r.shapes().subroutine=wt,r.shapes().cylinder=xt,r.shapes().rect_left_inv_arrow=ut,r.shapes().lean_right=ft,r.shapes().lean_left=pt,r.shapes().trapezoid=vt,r.shapes().inv_trapezoid=yt,r.shapes().rect_right_inv_arrow=gt}l(ge,"addToRender");function me(r){r({question:dt}),r({hexagon:ht}),r({stadium:mt}),r({subroutine:wt}),r({cylinder:xt}),r({rect_left_inv_arrow:ut}),r({lean_right:ft}),r({lean_left:pt}),r({trapezoid:vt}),r({inv_trapezoid:yt}),r({rect_right_inv_arrow:gt})}l(me,"addToRenderV2");function C(r,t,e,n){return r.insert("polygon",":first-child").attr("points",n.map(function(a){return a.x+","+a.y}).join(" ")).attr("transform","translate("+-t/2+","+e/2+")")}l(C,"insertPolygonShape");const we={addToRender:ge,addToRenderV2:me},bt={},xe=l(function(r){const t=Object.keys(r);for(const e of t)bt[e]=r[e]},"setConf"),kt=l(function(r,t,e,n,a,s){const i=n?n.select(`[id="${e}"]`):b(`[id="${e}"]`),o=a||document;Object.keys(r).forEach(function(h){const c=r[h];let y="default";c.classes.length>0&&(y=c.classes.join(" "));const u=Y(c.styles);let f=c.text!==void 0?c.text:c.id,v;if(rt(K().flowchart.htmlLabels)){const g={label:f.replace(/fa[blrs]?:fa-[\w-]+/g,S=>`<i class='${S.replace(":"," ")}'></i>`)};v=nt(i,g).node(),v.parentNode.removeChild(v)}else{const g=o.createElementNS("http://www.w3.org/2000/svg","text");g.setAttribute("style",u.labelStyle.replace("color:","fill:"));const S=f.split(at.lineBreakRegex);for(const B of S){const _=o.createElementNS("http://www.w3.org/2000/svg","tspan");_.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),_.setAttribute("dy","1em"),_.setAttribute("x","1"),_.textContent=B,g.appendChild(_)}v=g}let m=0,p="";switch(c.type){case"round":m=5,p="rect";break;case"square":p="rect";break;case"diamond":p="question";break;case"hexagon":p="hexagon";break;case"odd":p="rect_left_inv_arrow";break;case"lean_right":p="lean_right";break;case"lean_left":p="lean_left";break;case"trapezoid":p="trapezoid";break;case"inv_trapezoid":p="inv_trapezoid";break;case"odd_right":p="rect_left_inv_arrow";break;case"circle":p="circle";break;case"ellipse":p="ellipse";break;case"stadium":p="stadium";break;case"subroutine":p="subroutine";break;case"cylinder":p="cylinder";break;case"group":p="rect";break;default:p="rect"}D.warn("Adding node",c.id,c.domId),t.setNode(s.db.lookUpDomId(c.id),{labelType:"svg",labelStyle:u.labelStyle,shape:p,label:v,rx:m,ry:m,class:y,style:u.style,id:s.db.lookUpDomId(c.id)})})},"addVertices"),St=l(function(r,t,e){let n=0,a,s;if(r.defaultStyle!==void 0){const i=Y(r.defaultStyle);a=i.style,s=i.labelStyle}r.forEach(function(i){n++;const o="L-"+i.start+"-"+i.end,d="LS-"+i.start,h="LE-"+i.end,c={};i.type==="arrow_open"?c.arrowhead="none":c.arrowhead="normal";let y="",u="";if(i.style!==void 0){const f=Y(i.style);y=f.style,u=f.labelStyle}else switch(i.stroke){case"normal":y="fill:none",a!==void 0&&(y=a),s!==void 0&&(u=s);break;case"dotted":y="fill:none;stroke-width:2px;stroke-dasharray:3;";break;case"thick":y=" stroke-width: 3.5px;fill:none";break}c.style=y,c.labelStyle=u,i.interpolate!==void 0?c.curve=z(i.interpolate,U):r.defaultInterpolate!==void 0?c.curve=z(r.defaultInterpolate,U):c.curve=z(bt.curve,U),i.text===void 0?i.style!==void 0&&(c.arrowheadStyle="fill: #333"):(c.arrowheadStyle="fill: #333",c.labelpos="c",rt(K().flowchart.htmlLabels)?(c.labelType="html",c.label=`<span id="L-${o}" class="edgeLabel L-${d}' L-${h}" style="${c.labelStyle}">${i.text.replace(/fa[blrs]?:fa-[\w-]+/g,f=>`<i class='${f.replace(":"," ")}'></i>`)}</span>`):(c.labelType="text",c.label=i.text.replace(at.lineBreakRegex,`
`),i.style===void 0&&(c.style=c.style||"stroke: #333; stroke-width: 1.5px;fill:none"),c.labelStyle=c.labelStyle.replace("color:","fill:"))),c.id=o,c.class=d+" "+h,c.minlen=i.length||1,t.setEdge(e.db.lookUpDomId(i.start),e.db.lookUpDomId(i.end),c,n)})},"addEdges"),be=l(function(r,t){D.info("Extracting classes"),t.db.clear();try{return t.parse(r),t.db.getClasses()}catch(e){return D.error(e),{}}},"getClasses"),ke=l(function(r,t,e,n){D.info("Drawing flowchart"),n.db.clear();const{securityLevel:a,flowchart:s}=K();let i;a==="sandbox"&&(i=b("#i"+t));const o=a==="sandbox"?b(i.nodes()[0].contentDocument.body):b("body"),d=a==="sandbox"?i.nodes()[0].contentDocument:document;let h=n.db.getDirection();h===void 0&&(h="TD");const c=s.nodeSpacing||50,y=s.rankSpacing||50,u=new Ct({multigraph:!0,compound:!0}).setGraph({rankdir:h,nodesep:c,ranksep:y,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});let f;const v=n.db.getSubGraphs();for(let w=v.length-1;w>=0;w--)f=v[w],n.db.addVertex(f.id,f.title,"group",void 0,f.classes);const m=n.db.getVertices();D.warn("Get vertices",m);const p=n.db.getEdges();let g=0;for(g=v.length-1;g>=0;g--){f=v[g],Dt("cluster").append("text");for(let w=0;w<f.nodes.length;w++)D.warn("Setting subgraph",f.nodes[w],n.db.lookUpDomId(f.nodes[w]),n.db.lookUpDomId(f.id)),u.setParent(n.db.lookUpDomId(f.nodes[w]),n.db.lookUpDomId(f.id))}kt(m,u,t,o,d,n),St(p,u,n);const S=new ue;we.addToRender(S),S.arrows().none=l(function(k,E,x,M){const I=k.append("marker").attr("id",E).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 0 0 L 0 0 z");A(I,x[M+"Style"])},"normal"),S.arrows().normal=l(function(k,E){k.append("marker").attr("id",E).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowheadPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"normal");const B=o.select(`[id="${t}"]`),_=o.select("#"+t+" g");for(S(_,u),_.selectAll("g.node").attr("title",function(){return n.db.getTooltip(this.id)}),n.db.indexNodes("subGraph"+g),g=0;g<v.length;g++)if(f=v[g],f.title!=="undefined"){const w=d.querySelectorAll("#"+t+' [id="'+n.db.lookUpDomId(f.id)+'"] rect'),k=d.querySelectorAll("#"+t+' [id="'+n.db.lookUpDomId(f.id)+'"]'),E=w[0].x.baseVal.value,x=w[0].y.baseVal.value,M=w[0].width.baseVal.value,I=b(k[0]).select(".label");I.attr("transform",`translate(${E+M/2}, ${x+14})`),I.attr("id",t+"Text");for(let W=0;W<f.classes.length;W++)k[0].classList.add(f.classes[W])}if(!s.htmlLabels){const w=d.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const k of w){const E=k.getBBox(),x=d.createElementNS("http://www.w3.org/2000/svg","rect");x.setAttribute("rx",0),x.setAttribute("ry",0),x.setAttribute("width",E.width),x.setAttribute("height",E.height),k.insertBefore(x,k.firstChild)}}It(u,B,s.diagramPadding,s.useMaxWidth),Object.keys(m).forEach(function(w){const k=m[w];if(k.link){const E=o.select("#"+t+' [id="'+n.db.lookUpDomId(w)+'"]');if(E){const x=d.createElementNS("http://www.w3.org/2000/svg","a");x.setAttributeNS("http://www.w3.org/2000/svg","class",k.classes.join(" ")),x.setAttributeNS("http://www.w3.org/2000/svg","href",k.link),x.setAttributeNS("http://www.w3.org/2000/svg","rel","noopener"),a==="sandbox"?x.setAttributeNS("http://www.w3.org/2000/svg","target","_top"):k.linkTarget&&x.setAttributeNS("http://www.w3.org/2000/svg","target",k.linkTarget);const M=E.insert(function(){return x},":first-child"),P=E.select(".label-container");P&&M.append(function(){return P.node()});const I=E.select(".label");I&&M.append(function(){return I.node()})}}})},"draw"),Se={setConf:xe,addVertices:kt,addEdges:St,getClasses:be,draw:ke},Qe={parser:Et,db:V,renderer:Bt,styles:Mt,init:r=>{r.flowchart||(r.flowchart={}),r.flowchart.arrowMarkerAbsolute=r.arrowMarkerAbsolute,Se.setConf(r.flowchart),V.clear(),V.setGen("gen-1")}};export{Qe as diagram};
//# sourceMappingURL=flowDiagram-698c8d5d-82c33f6c.js.map
